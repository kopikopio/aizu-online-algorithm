どれかのアルゴリズムに無駄な処理が残っていたと思う